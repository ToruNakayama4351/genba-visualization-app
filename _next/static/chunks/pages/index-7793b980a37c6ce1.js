(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(1641)}])},1641:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return P}});var l={};a.r(l);var s=a(5893),r=a(7294),n=a(1536),i=a(4715),d=a(9984),c=a(7017),o=a(5615),m=a(8793),h=a(4570),x=a(8042),u=a(2775),g=a(723),p=a(1712),f=a(8660),b=a(2054),j=a(4489),y=a(2514),N=a(3349),w=a(7977),v=a(2547),S=a(5433),k=a(3034),C=a(348),T=a(4671),D=a(6008),A=a(905),_=a(2664),Z=a(382),M=a(9387),L=a(2471),E=a(4391),R=a(6672),F=a(1382),J=a(2379),O=a(5618);function P(){let[e,t]=(0,r.useState)(""),[a,P]=(0,r.useState)([]),[K,I]=(0,r.useState)([]),[z,U]=(0,r.useState)("bar"),[q,X]=(0,r.useState)(!1),[B,$]=(0,r.useState)(!1),[G,Y]=(0,r.useState)(!1),[H,Q]=(0,r.useState)({name:"",type:"number"}),[V,W]=(0,r.useState)(""),[ee,et]=(0,r.useState)(!1),[ea,el]=(0,r.useState)([]),[es,er]=(0,r.useState)(0),[en,ei]=(0,r.useState)(""),[ed,ec]=(0,r.useState)({}),[eo,em]=(0,r.useState)(!1),[eh,ex]=(0,r.useState)([]),[eu,eg]=(0,r.useState)("home"),[ep,ef]=(0,r.useState)(null),eb=(0,r.useRef)(null),ej={quality:{name:"品質管理ダッシュボード",description:"不良率、品質スコア、検査結果の分析",preferredFields:["不良","品質","検査","良品","スコア","判定"],chartType:"composed",memo:"品質管理の可視化により、不良品の早期発見と品質向上を実現できます。\n• 不良率の推移監視\n• 品質基準値との比較\n• 検査結果のトレンド分析"},production:{name:"生産効率分析",description:"生産数、稼働率、作業時間の最適化",preferredFields:["生産","稼働","作業時間","効率","数量","SPM"],chartType:"bar",memo:"生産効率の見える化により、ボトルネックの特定と改善が可能です。\n• 生産数の日次推移\n• 設備稼働率の監視\n• 作業時間の最適化"},maintenance:{name:"設備保全レポート",description:"温度、振動、稼働時間の監視",preferredFields:["温度","湿度","ショット","累計","稼働","点検"],chartType:"line",memo:"予防保全により設備の長寿命化とダウンタイム削減を実現します。\n• 設備状態の常時監視\n• 保全タイミングの最適化\n• 異常予兆の早期検知"}},ey=e=>{if(!e||""===e.trim()){P([]),$(!1);return}$(!0);try{let t=JSON.parse(e),a=[];if(t.format&&t.format.boxes)t.format.boxes.forEach(e=>{if(e.name&&e.dataType){let t=eN(e.name,e.dataType);a.push({id:e.fieldID||e.name.replace(/[^a-zA-Z0-9]/g,"_"),name:e.name,type:t})}}),t.format.tables&&t.format.tables.forEach(e=>{e.columns&&e.columns.forEach(e=>{if(e.name&&e.dataType){let t=eN(e.name,e.dataType);a.push({id:e.columnID||e.name.replace(/[^a-zA-Z0-9]/g,"_"),name:e.name,type:t})}})});else{let e=function(t){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object.keys(t).forEach(s=>{let r=l?l+"."+s:s,n=t[s];if(n&&"object"==typeof n&&!Array.isArray(n))e(n,r);else{let e=eN(s,"number"==typeof n?"number":"string");a.push({id:r.replace(/[^a-zA-Z0-9]/g,"_"),name:s.replace(/_/g," ").replace(/([A-Z])/g," $1").trim(),type:e})}})};e(t)}P(a),$(!1)}catch(e){console.error("JSON解析エラー:",e),$(!1)}},eN=(e,t)=>{let a=e.toLowerCase();if(["spm","ピッチ","温度","湿度","数","率","ハイト","ショット","重","効率","スコア"].some(e=>a.includes(e)))return"number";if(["日","date","time","時"].some(e=>a.includes(e)))return"date";switch(t){case"int":case"float":case"number":return"number";case"date":return"date";default:return"string"}},ew=e=>{if(t(e),!e.trim()){P([]);return}setTimeout(()=>{ey(e)},300)},ev=e=>{P(t=>t.filter(t=>t.id!==e)),I(t=>t.filter(t=>t!==e))},eS=e=>{I(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},ek=e=>{let t=ej[e],l=a.filter(e=>t.preferredFields.some(t=>e.name.toLowerCase().includes(t.toLowerCase()))),s=[];if(l.length>0){let e=a.find(e=>"date"===e.type||e.name.toLowerCase().includes("日")||e.name.toLowerCase().includes("date")||e.name.toLowerCase().includes("time"));if(e&&!l.includes(e))s=[e.id,...l.map(e=>e.id)];else if(e){let t=l.filter(t=>t.id!==e.id);s=[e.id,...t.map(e=>e.id)]}else{let e={id:"dummy_date",name:"作業日（サンプル）",type:"date"};P(t=>[e,...t]),s=[e.id,...l.map(e=>e.id)]}I(s),U(t.chartType),W(t.memo)}else{let e=[{id:"dummy_date",name:"作業日（サンプル）",type:"date"},...t.preferredFields.slice(0,3).map((e,t)=>({id:"dummy_"+e.toLowerCase().replace(/[^a-zA-Z0-9]/g,"_"),name:e+"（サンプル）",type:"number"}))];P(t=>[...t,...e]),I(e.map(e=>e.id)),U(t.chartType),W(t.memo)}X(!0)},eC=async()=>new Promise(e=>{let t=document.querySelector(".recharts-wrapper svg");if(!t){let t=document.createElement("canvas"),a=t.getContext("2d");t.width=400,t.height=300,a.fillStyle="white",a.fillRect(0,0,t.width,t.height),a.fillStyle="#1f2937",a.font="bold 16px Arial",a.textAlign="center";let l={bar:"棒グラフ",line:"折れ線グラフ",pie:"円グラフ",composed:"複合グラフ",table:"表"}[z]||"グラフ";a.fillText(l,t.width/2,t.height/2),a.font="12px Arial",a.fillStyle="#6b7280",a.fillText(new Date().toLocaleString("ja-JP"),t.width/2,t.height/2+30),e(t.toDataURL());return}let a=new XMLSerializer().serializeToString(t),l=document.createElement("canvas"),s=l.getContext("2d");l.width=400,l.height=300;let r=new Image;r.onload=function(){s.fillStyle="white",s.fillRect(0,0,l.width,l.height);let t=Math.min(l.width/r.width,l.height/r.height),a=(l.width-r.width*t)/2,n=(l.height-r.height*t)/2;s.drawImage(r,a,n,r.width*t,r.height*t),e(l.toDataURL())},r.onerror=function(){s.fillStyle="white",s.fillRect(0,0,l.width,l.height),s.fillStyle="#1f2937",s.font="bold 16px Arial",s.textAlign="center",s.fillText("グラフ画像",l.width/2,l.height/2),e(l.toDataURL())},r.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(a)))}),eT=async()=>{if(!en.trim()){alert("プロジェクト名を入力してください");return}let e=prompt("パターン名を入力してください","パターン"+(ea.length+1));if(e){let t=await eC(),a=[...ea,{id:Date.now().toString(),name:e,selectedFields:[...K],chartType:z,memo:V,alertSettings:{...ed},timestamp:new Date().toLocaleString("ja-JP"),chartImage:t}];el(a),eD(a)}},eD=t=>{let l={id:en.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),name:en,jsonData:e,extractedFields:a,patterns:t,savedAt:new Date().toLocaleString("ja-JP"),lastModified:new Date().toLocaleString("ja-JP")};ex(e=>{let t=e.findIndex(e=>e.id===l.id);if(!(t>=0))return[...e,l];{let a=[...e];return a[t]=l,a}})},eA=e=>{e.chartImage?window.open("","_blank").document.write("\n        <html>\n          <head><title>".concat(e.name,' - 拡大プレビュー</title></head>\n          <body style="margin: 0; padding: 20px; text-align: center; background: #f9fafb;">\n            <h2>').concat(e.name,"</h2>\n            <p>作成日時: ").concat(e.timestamp,'</p>\n            <img src="').concat(e.chartImage,'" style="max-width: 100%; border: 1px solid #ddd; border-radius: 8px;"/>\n          </body>\n        </html>\n      ')):alert("チャート画像が保存されていません")},e_=(e,t)=>{let a=document.createElement("canvas"),l=a.getContext("2d");a.width=800,a.height=600,l.fillStyle="white",l.fillRect(0,0,a.width,a.height),l.fillStyle="#1f2937",l.font="bold 24px Arial",l.textAlign="center",l.fillText("".concat(e," - ").concat(t.name),a.width/2,50),l.font="16px Arial",l.fillText("作成日時: ".concat(t.timestamp),a.width/2,80),l.fillText("グラフタイプ: ".concat(t.chartType),a.width/2,110);let s=document.createElement("a");s.download="".concat(e,"_").concat(t.name,"_").concat(new Date().toLocaleDateString("ja-JP"),".png"),s.href=a.toDataURL(),s.click()},eZ=(e,t,a)=>{ec(l=>({...l,[e]:{min:parseFloat(t)||null,max:parseFloat(a)||null}}))},eM=(e,t)=>{let a=ed[e];return!!a&&(null!==a.min&&t<a.min||null!==a.max&&t>a.max)},eL=async()=>{et(!0);try{let e=document.createElement("canvas"),t=e.getContext("2d");e.width=1200,e.height=1600,t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t.fillStyle="#1f2937",t.font="bold 24px Arial",t.textAlign="center";let l={bar:"棒グラフ",line:"折れ線グラフ",pie:"円グラフ",composed:"複合グラフ",table:"表"}[z];t.fillText("データ可視化 - "+l,e.width/2,40),en&&(t.font="16px Arial",t.fillStyle="#6b7280",t.fillText("プロジェクト: "+en,e.width/2,70)),t.font="16px Arial",t.textAlign="left",t.fillStyle="#1f2937",t.fillText("選択項目:",50,100);let s=120;K.forEach(e=>{let l=a.find(t=>t.id===e);l&&(t.fillText("• "+l.name+" ("+l.type+")",70,s),s+=25)});let r=s+20;t.strokeStyle="#e5e7eb",t.strokeRect(50,r,e.width-100,400),t.fillStyle="#f3f4f6",t.fillRect(51,r+1,e.width-102,398),t.fillStyle="#6b7280",t.font="18px Arial",t.textAlign="center",t.fillText("チャートエリア",e.width/2,r+200),t.fillText("("+l+")",e.width/2,r+200+30);let n=r+400+40;t.fillStyle="#1f2937",t.font="bold 18px Arial",t.textAlign="left",t.fillText("メモ・要望:",50,n),t.strokeStyle="#d1d5db",t.strokeRect(50,n+10,e.width-100,200),t.fillStyle="#f9fafb",t.fillRect(51,n+11,e.width-102,198),t.fillStyle="#374151",t.font="14px Arial";let i=V.split("\n"),d=n+35;i.forEach(e=>{t.fillText(e,70,d),d+=20}),t.fillStyle="#6b7280",t.font="12px Arial",t.textAlign="center";let c=new Date,o=c.toLocaleDateString("ja-JP")+" "+c.toLocaleTimeString("ja-JP");t.fillText("作成日時: "+o,e.width/2,e.height-20);let m=document.createElement("a"),h=(en?en+"_":"")+"データ可視化_"+l+"_"+c.getFullYear()+String(c.getMonth()+1).padStart(2,"0")+String(c.getDate()).padStart(2,"0")+".png";m.download=h,m.href=e.toDataURL(),m.click()}catch(e){console.error("エクスポートエラー:",e),alert("エクスポートに失敗しました")}et(!1)},eE=(0,r.useMemo)(()=>{let e=[];for(let t=0;t<30;t++){let l={};a.forEach(e=>{switch(e.type){case"date":l[e.id]="2024-"+String(Math.floor(t/30)+1).padStart(2,"0")+"-"+String(t%30+1).padStart(2,"0");break;case"number":e.name.includes("温度")?l[e.id]=Math.floor(10*Math.random())+20:e.name.includes("湿度")?l[e.id]=Math.floor(20*Math.random())+40:e.name.includes("生産")?l[e.id]=Math.floor(50*Math.random())+100:e.name.includes("不良")?l[e.id]=Math.floor(10*Math.random()):e.name.includes("SPM")?l[e.id]=Math.floor(50*Math.random())+100:e.name.includes("ショット")?l[e.id]=Math.floor(1e3*Math.random())+5e3:l[e.id]=Math.floor(100*Math.random());break;case"string":if(e.name.includes("作業者")||e.name.includes("worker")){let t=["田中","佐藤","鈴木","高橋","渡邊"];l[e.id]=t[Math.floor(Math.random()*t.length)]}else e.name.includes("機械")||e.name.includes("machine")?l[e.id]="M"+String(Math.floor(5*Math.random())+1).padStart(3,"0"):l[e.id]="データ"+(t+1);break;default:l[e.id]="値"+(t+1)}}),e.push(l)}return e},[a]);return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6 text-gray-900",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsxs)("header",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"帳票データ可視化アプリケーション"}),(0,s.jsx)("p",{className:"text-gray-900",children:"JSONデータから自動で項目を抽出し、お客様とのすり合わせ用グラフ・表を生成"}),(0,s.jsxs)("div",{className:"flex justify-center gap-4 mt-6",children:[(0,s.jsxs)("button",{onClick:()=>eg("home"),className:"nav-button ".concat("home"===eu?"active":""),children:[(0,s.jsx)(w.Z,{className:"h-5 w-5 mr-2"}),"ホーム"]}),(0,s.jsxs)("button",{onClick:()=>eg("history"),className:"nav-button ".concat("history"===eu?"active":""),children:[(0,s.jsx)(v.Z,{className:"h-5 w-5 mr-2"}),"プロジェクト履歴"]})]})]}),"home"===eu?(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,s.jsxs)("div",{className:"project-header",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold flex items-center",children:[(0,s.jsx)(S.Z,{className:"mr-2"}),(0,s.jsx)("span",{className:"text-gray-900",children:"プロジェクト管理"})]}),(0,s.jsxs)("button",{onClick:()=>{if((K.length>0||V.trim()||Object.keys(ed).length>0)&&en.trim()){if(!window.confirm("現在の作業内容をプロジェクト「".concat(en,"」に保存してからリセットしますか？\n\n")+"「OK」: 保存してリセット\n「キャンセル」: リセットせずに作業を続ける"))return;if(K.length>0){let e="作業中パターン_"+new Date().toLocaleTimeString("ja-JP");eD([...ea,{id:Date.now().toString(),name:e,selectedFields:[...K],chartType:z,memo:V,alertSettings:{...ed},timestamp:new Date().toLocaleString("ja-JP"),exportedImage:null}])}else ea.length>0&&eD(ea)}ei(""),t(""),P([]),I([]),el([]),U("bar"),W(""),ec({}),X(!1),Y(!1),em(!1),$(!1),alert("新しいプロジェクトを開始できます")},className:"flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[(0,s.jsx)(k.Z,{className:"h-4 w-4 mr-2"}),"新しいプロジェクトを開始"]})]}),(0,s.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,s.jsx)("input",{type:"text",value:en,onChange:e=>ei(e.target.value),placeholder:"プロジェクト名を入力（例: A社_品質改善_2024）",className:"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),ea.length>0&&(0,s.jsxs)("div",{className:"text-sm text-gray-900",children:["保存済みパターン: ",ea.length,"個"]})]})]}),(0,s.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 json-file-section",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-6 flex items-center justify-center",children:[(0,s.jsx)(C.Z,{className:"mr-2"}),"JSONデータ取り込み"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("button",{onClick:()=>{var e;return null===(e=eb.current)||void 0===e?void 0:e.click()},className:"file-input-label w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center",children:[(0,s.jsx)(T.Z,{className:"h-5 w-5 mr-2"}),"JSONファイルを選択"]}),(0,s.jsx)("div",{className:"text-center text-gray-800 text-sm",children:"または"}),(0,s.jsx)("textarea",{value:e,onChange:e=>ew(e.target.value),className:"w-full h-40 p-4 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"JSONデータを直接入力してください..."})]}),(0,s.jsx)("input",{ref:eb,type:"file",accept:".json",onChange:e=>{let a=e.target.files[0];if(a){let e=new FileReader;e.onload=e=>{t(e.target.result),ey(e.target.result)},e.readAsText(a)}},className:"hidden"})]})}),a.length>0&&(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,s.jsx)(D.Z,{className:"mr-2"}),"提案テンプレート"]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(ej).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg mb-2",children:a.name}),(0,s.jsx)("p",{className:"text-gray-900 text-sm mb-3",children:a.description}),(0,s.jsx)("button",{onClick:()=>ek(t),className:"w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"このテンプレートを適用"})]},t)})})]}),(a.length>0||B)&&(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold flex items-center",children:[(0,s.jsx)(A.Z,{className:"mr-2"}),"抽出された項目",B&&(0,s.jsx)("span",{className:"ml-2 text-blue-600",children:"解析中..."})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>Y(!G),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center",children:[(0,s.jsx)(_.Z,{className:"h-4 w-4 mr-2"}),"項目追加"]}),(0,s.jsxs)("button",{onClick:()=>em(!eo),className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center",children:[(0,s.jsx)(Z.Z,{className:"h-4 w-4 mr-2"}),"異常値設定"]})]})]}),G&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:(0,s.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"項目名"}),(0,s.jsx)("input",{type:"text",value:H.name,onChange:e=>Q({...H,name:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"例: 作業効率, 検査回数"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"データ型"}),(0,s.jsxs)("select",{value:H.type,onChange:e=>Q({...H,type:e.target.value}),className:"p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,s.jsx)("option",{value:"number",children:"数値"}),(0,s.jsx)("option",{value:"string",children:"文字列"}),(0,s.jsx)("option",{value:"date",children:"日付"})]})]}),(0,s.jsx)("button",{onClick:()=>{if(H.name.trim()){let e={id:H.name.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),name:H.name,type:H.type};P(t=>[...t,e]),Q({name:"",type:"number"}),Y(!1)}},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"追加"})]})}),eo&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-orange-50 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-medium mb-3",children:"異常値検知設定"}),(0,s.jsx)("div",{className:"space-y-3",children:a.filter(e=>"number"===e.type).map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("span",{className:"w-32 text-sm font-medium",children:[e.name,":"]}),(0,s.jsx)("input",{type:"number",placeholder:"下限値",className:"w-20 p-1 border border-gray-300 rounded text-sm",onChange:t=>{var a;return eZ(e.id,t.target.value,null===(a=ed[e.id])||void 0===a?void 0:a.max)}}),(0,s.jsx)("span",{className:"text-gray-800",children:"〜"}),(0,s.jsx)("input",{type:"number",placeholder:"上限値",className:"w-20 p-1 border border-gray-300 rounded text-sm",onChange:t=>{var a;return eZ(e.id,null===(a=ed[e.id])||void 0===a?void 0:a.min,t.target.value)}})]},e.id))}),(0,s.jsx)("div",{className:"mt-3 p-2 bg-blue-100 rounded",children:(0,s.jsx)("p",{className:"text-sm text-blue-800",children:"\uD83D\uDCA1 ヒント: 異常値の参照線がグラフに表示されます"})})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-6",children:a.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[(0,s.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer flex-1",children:[(0,s.jsx)("input",{type:"checkbox",checked:K.includes(e.id),onChange:()=>eS(e.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:e.name}),(0,s.jsx)("span",{className:"ml-2 text-xs text-gray-800 bg-gray-100 px-2 py-1 rounded",children:e.type}),ed[e.id]&&(0,s.jsx)(N.Z,{className:"inline h-3 w-3 ml-1 text-orange-500"})]})]}),(0,s.jsx)("button",{onClick:()=>ev(e.id),className:"ml-2 text-red-500 hover:text-red-700 transition-colors",children:(0,s.jsx)(M.Z,{className:"h-4 w-4"})})]},e.id))}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"可視化タイプ選択"}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[{type:"bar",icon:L.Z,name:"棒グラフ"},{type:"line",icon:E.Z,name:"折れ線グラフ"},{type:"pie",icon:R.Z,name:"円グラフ"},{type:"composed",icon:L.Z,name:"複合グラフ"},{type:"table",icon:l.Grid3X3,name:"表"}].map(e=>{let{type:t,icon:a,name:l}=e;return(0,s.jsxs)("button",{onClick:()=>U(t),className:"p-3 rounded-lg border-2 transition-all "+(z===t?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:[(0,s.jsx)(a,{className:"h-6 w-6 mx-auto mb-1"}),(0,s.jsx)("div",{className:"text-sm font-medium",children:l})]},t)})})]}),(0,s.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("h3",{className:"font-medium mb-3 flex items-center",children:[(0,s.jsx)(A.Z,{className:"h-4 w-4 mr-2"}),"お客様からの要望・メモ"]}),(0,s.jsx)("textarea",{value:V,onChange:e=>W(e.target.value),className:"w-full h-32 p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"お客様からの要望や気づいた点をメモしてください..."}),(0,s.jsx)("p",{className:"text-sm text-gray-800 mt-2",children:"このメモも一緒に画像として出力されます"})]}),(0,s.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,s.jsxs)("button",{onClick:()=>X(!0),disabled:0===K.length,className:"flex items-center space-x-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[(0,s.jsx)(F.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"プレビュー生成"})]}),(0,s.jsxs)("button",{onClick:eT,disabled:0===K.length,className:"flex items-center space-x-2 bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[(0,s.jsx)(J.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"パターン保存"})]})]})]}),q&&K.length>0&&(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold",children:["プレビュー - ",{bar:"棒グラフ",line:"折れ線グラフ",pie:"円グラフ",composed:"複合グラフ",table:"表"}[z]]}),(0,s.jsxs)("button",{onClick:eL,disabled:ee,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 transition-colors",children:[(0,s.jsx)(O.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:ee?"エクスポート中...":"メモ付きエクスポート"})]})]}),(0,s.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(()=>{if(0===K.length)return null;let e=["#8884d8","#82ca9d","#ffc658","#ff7c7c","#8dd1e1"],t=e=>{let{active:t,payload:a,label:l}=e;return t&&a&&a.length?(0,s.jsxs)("div",{className:"bg-white p-3 border border-gray-300 rounded shadow-lg",children:[(0,s.jsx)("p",{className:"font-medium",children:l}),a.map((e,t)=>{let a=eM(e.dataKey,e.value);return(0,s.jsxs)("p",{style:{color:e.color},className:a?"font-bold":"",children:[e.name,": ",e.value,a&&(0,s.jsx)("span",{className:"text-red-500 ml-2",children:"⚠️異常値"})]},t)})]}):null};switch(z){case"bar":return(0,s.jsx)(i.h,{width:"100%",height:400,children:(0,s.jsxs)(d.v,{data:eE.slice(0,10),children:[(0,s.jsx)(c.q,{strokeDasharray:"3 3"}),(0,s.jsx)(o.K,{dataKey:K[0]}),(0,s.jsx)(m.B,{}),(0,s.jsx)(h.u,{content:(0,s.jsx)(t,{})}),(0,s.jsx)(x.D,{}),K.slice(1).map((t,l)=>{let r=a.find(e=>e.id===t);return(null==r?void 0:r.type)==="number"?(0,s.jsx)(n.$,{dataKey:t,fill:e[l%e.length],name:r.name},t):null}),K.slice(1).map((e,t)=>{let a=ed[e];return a?(0,s.jsxs)(r.Fragment,{children:[null!==a.max&&(0,s.jsx)(u.d,{y:a.max,stroke:"red",strokeDasharray:"5 5",label:"上限"}),null!==a.min&&(0,s.jsx)(u.d,{y:a.min,stroke:"red",strokeDasharray:"5 5",label:"下限"})]},e+"_alert"):null})]})});case"line":return(0,s.jsx)(i.h,{width:"100%",height:400,children:(0,s.jsxs)(g.w,{data:eE.slice(0,15),children:[(0,s.jsx)(c.q,{strokeDasharray:"3 3"}),(0,s.jsx)(o.K,{dataKey:K[0]}),(0,s.jsx)(m.B,{}),(0,s.jsx)(h.u,{content:(0,s.jsx)(t,{})}),(0,s.jsx)(x.D,{}),K.slice(1).map((t,l)=>{let r=a.find(e=>e.id===t);return(null==r?void 0:r.type)==="number"?(0,s.jsx)(p.x,{type:"monotone",dataKey:t,stroke:e[l%e.length],name:r.name},t):null}),K.slice(1).map((e,t)=>{let a=ed[e];return a?(0,s.jsxs)(r.Fragment,{children:[null!==a.max&&(0,s.jsx)(u.d,{y:a.max,stroke:"red",strokeDasharray:"5 5",label:"上限"}),null!==a.min&&(0,s.jsx)(u.d,{y:a.min,stroke:"red",strokeDasharray:"5 5",label:"下限"})]},e+"_alert"):null})]})});case"pie":let l=K.find(e=>{let t=a.find(t=>t.id===e);return(null==t?void 0:t.type)==="string"});if(!l)return(0,s.jsx)("div",{className:"text-gray-800",children:"円グラフには文字列項目を選択してください"});let w=Object.entries(eE.reduce((e,t)=>{let a=t[l];return e[a]=(e[a]||0)+1,e},{})).map(e=>{let[t,a]=e;return{name:t,value:a}});return(0,s.jsx)(i.h,{width:"100%",height:400,children:(0,s.jsxs)(f.u,{children:[(0,s.jsx)(b.b,{data:w,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:a}=e;return t+" "+(100*a).toFixed(0)+"%"},outerRadius:80,fill:"#8884d8",dataKey:"value",children:w.map((t,a)=>(0,s.jsx)(j.b,{fill:e[a%e.length]},"cell-"+a))}),(0,s.jsx)(h.u,{})]})});case"composed":return(0,s.jsx)(i.h,{width:"100%",height:400,children:(0,s.jsxs)(y.c,{data:eE.slice(0,12),children:[(0,s.jsx)(c.q,{strokeDasharray:"3 3"}),(0,s.jsx)(o.K,{dataKey:K[0]}),(0,s.jsx)(m.B,{}),(0,s.jsx)(h.u,{content:(0,s.jsx)(t,{})}),(0,s.jsx)(x.D,{}),K.slice(1).map((t,l)=>{let r=a.find(e=>e.id===t);return(null==r?void 0:r.type)==="number"?l%2==0?(0,s.jsx)(n.$,{dataKey:t,fill:e[l%e.length],name:r.name},t):(0,s.jsx)(p.x,{type:"monotone",dataKey:t,stroke:e[l%e.length],name:r.name},t):null})]})});case"table":return(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,s.jsx)("thead",{children:(0,s.jsx)("tr",{className:"bg-gray-50",children:K.map(e=>{let t=a.find(t=>t.id===e);return(0,s.jsxs)("th",{className:"border border-gray-300 px-4 py-2 text-left font-medium",children:[null==t?void 0:t.name,ed[e]&&(0,s.jsx)(N.Z,{className:"inline h-4 w-4 ml-1 text-red-500"})]},e)})})}),(0,s.jsx)("tbody",{children:eE.slice(0,10).map((e,t)=>(0,s.jsx)("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:K.map(t=>{let a=e[t],l=eM(t,a);return(0,s.jsxs)("td",{className:"border border-gray-300 px-4 py-2"+(l?" bg-red-100 text-red-700 font-bold":""),children:[a,l&&(0,s.jsx)("span",{className:"ml-2",children:"⚠️"})]},t)})},t))})]})});default:return null}})()}),(0,s.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-medium mb-2",children:"選択中の項目:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:K.map(e=>{let t=a.find(t=>t.id===e),l=ed[e];return(0,s.jsxs)("span",{className:l?"bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm":"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[null==t?void 0:t.name,l&&(0,s.jsx)(N.Z,{className:"inline h-3 w-3 ml-1"})]},e)})}),Object.keys(ed).length>0&&(0,s.jsx)("div",{className:"mt-3 p-2 bg-orange-100 rounded",children:(0,s.jsxs)("p",{className:"text-sm text-orange-800",children:[(0,s.jsx)(N.Z,{className:"inline h-4 w-4 mr-1"}),"異常値監視が有効です。設定された閾値を超えた値は赤色で表示されます。"]})})]})]})]}):(0,s.jsx)("div",{className:"space-y-6",children:0===eh.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(S.Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"保存されたプロジェクトはありません"}),(0,s.jsx)("p",{className:"text-gray-800",children:"ホーム画面でプロジェクトを作成してパターンを保存してください"})]}):(0,s.jsx)("div",{className:"grid gap-6",children:eh.map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,s.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:e.name}),(0,s.jsxs)("p",{className:"text-gray-800 text-sm",children:["作成: ",e.savedAt," | 最終更新: ",e.lastModified]}),(0,s.jsxs)("p",{className:"text-gray-900 text-sm mt-1",children:["パターン数: ",e.patterns.length,"個"]})]})}),e.patterns.length>0&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:"保存されたパターン:"}),(0,s.jsx)("div",{className:"grid gap-3",children:e.patterns.map(t=>(0,s.jsxs)("div",{className:"flex gap-4 p-3 bg-gray-50 rounded-lg",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:t.chartImage?(0,s.jsx)("img",{src:t.chartImage,alt:"".concat(t.name,"のグラフ"),className:"w-24 h-20 object-cover border border-gray-300 rounded cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>eA(t),title:"クリックで拡大表示"}):(0,s.jsx)("div",{className:"w-24 h-20 bg-gray-200 border border-gray-300 rounded flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-xs text-gray-500 text-center",children:"画像なし"})})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h5",{className:"font-medium text-gray-800",children:t.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-900",children:["bar"===t.chartType?"棒グラフ":"line"===t.chartType?"折れ線グラフ":"pie"===t.chartType?"円グラフ":"composed"===t.chartType?"複合グラフ":"表"," | ",t.timestamp]}),t.memo&&(0,s.jsxs)("p",{className:"text-sm text-gray-800 mt-1 line-clamp-2",children:["メモ: ",t.memo]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("button",{onClick:()=>eA(t),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",title:"拡大表示",children:"拡大"}),(0,s.jsx)("button",{onClick:()=>e_(e.name,t),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors",children:"DL"})]})]},t.id))})]})]},e.id))})})]})})}}},function(e){e.O(0,[119,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);