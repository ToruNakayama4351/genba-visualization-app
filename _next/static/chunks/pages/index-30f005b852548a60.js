(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(1641)}])},1641:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return P}});var s={};l.r(s);var a=l(5893),r=l(7294),n=l(1536),i=l(4715),d=l(9984),c=l(7017),o=l(5615),m=l(8793),x=l(4570),h=l(8042),g=l(2775),u=l(723),p=l(1712),b=l(8660),f=l(2054),j=l(4489),y=l(2514),N=l(3349),w=l(7977),v=l(2547),S=l(5433),k=l(3034),C=l(348),D=l(4671),T=l(6008),_=l(905),A=l(2664),Z=l(382),L=l(9387),J=l(2471),R=l(4391),O=l(6672),F=l(1382),E=l(2379),K=l(5618);function P(){let[e,t]=(0,r.useState)(""),[l,P]=(0,r.useState)([]),[I,z]=(0,r.useState)([]),[M,U]=(0,r.useState)("bar"),[q,X]=(0,r.useState)(!1),[B,$]=(0,r.useState)(!1),[G,Y]=(0,r.useState)(!1),[H,Q]=(0,r.useState)({name:"",type:"number"}),[V,W]=(0,r.useState)(""),[ee,et]=(0,r.useState)(!1),[el,es]=(0,r.useState)([]),[ea,er]=(0,r.useState)(0),[en,ei]=(0,r.useState)(""),[ed,ec]=(0,r.useState)({}),[eo,em]=(0,r.useState)(!1),[ex,eh]=(0,r.useState)([]),[eg,eu]=(0,r.useState)("home"),[ep,eb]=(0,r.useState)(null),ef=(0,r.useRef)(null),ej={quality:{name:"品質管理ダッシュボード",description:"不良率、品質スコア、検査結果の分析",preferredFields:["不良","品質","検査","良品","スコア","判定"],chartType:"composed",memo:"品質管理の可視化により、不良品の早期発見と品質向上を実現できます。\n• 不良率の推移監視\n• 品質基準値との比較\n• 検査結果のトレンド分析"},production:{name:"生産効率分析",description:"生産数、稼働率、作業時間の最適化",preferredFields:["生産","稼働","作業時間","効率","数量","SPM"],chartType:"bar",memo:"生産効率の見える化により、ボトルネックの特定と改善が可能です。\n• 生産数の日次推移\n• 設備稼働率の監視\n• 作業時間の最適化"},maintenance:{name:"設備保全レポート",description:"温度、振動、稼働時間の監視",preferredFields:["温度","湿度","ショット","累計","稼働","点検"],chartType:"line",memo:"予防保全により設備の長寿命化とダウンタイム削減を実現します。\n• 設備状態の常時監視\n• 保全タイミングの最適化\n• 異常予兆の早期検知"}},ey=e=>{if(console.log("JSON処理を開始:",e),!e||""===e.trim()){P([]),$(!1);return}$(!0);try{let t=JSON.parse(e);console.log("JSON解析成功:",t),P([{id:"test1",name:"テスト項目1",type:"string"},{id:"test2",name:"テスト項目2",type:"number"}]),$(!1)}catch(e){console.error("JSON解析エラー:",e),P([]),$(!1)}},eN=e=>{P(t=>t.filter(t=>t.id!==e)),z(t=>t.filter(t=>t!==e))},ew=e=>{z(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},ev=e=>{let t=ej[e],s=l.filter(e=>t.preferredFields.some(t=>e.name.toLowerCase().includes(t.toLowerCase()))),a=[];if(s.length>0){let e=l.find(e=>"date"===e.type||e.name.toLowerCase().includes("日")||e.name.toLowerCase().includes("date")||e.name.toLowerCase().includes("time"));if(e&&!s.includes(e))a=[e.id,...s.map(e=>e.id)];else if(e){let t=s.filter(t=>t.id!==e.id);a=[e.id,...t.map(e=>e.id)]}else{let e={id:"dummy_date",name:"作業日（サンプル）",type:"date"};P(t=>[e,...t]),a=[e.id,...s.map(e=>e.id)]}z(a),U(t.chartType),W(t.memo)}else{let e=[{id:"dummy_date",name:"作業日（サンプル）",type:"date"},...t.preferredFields.slice(0,3).map((e,t)=>({id:"dummy_"+e.toLowerCase().replace(/[^a-zA-Z0-9]/g,"_"),name:e+"（サンプル）",type:"number"}))];P(t=>[...t,...e]),z(e.map(e=>e.id)),U(t.chartType),W(t.memo)}X(!0)},eS=async()=>new Promise(e=>{let t=document.querySelector(".recharts-wrapper svg");if(!t){let t=document.createElement("canvas"),l=t.getContext("2d");t.width=400,t.height=300,l.fillStyle="white",l.fillRect(0,0,t.width,t.height),l.fillStyle="#1f2937",l.font="bold 16px Arial",l.textAlign="center";let s={bar:"棒グラフ",line:"折れ線グラフ",pie:"円グラフ",composed:"複合グラフ",table:"表"}[M]||"グラフ";l.fillText(s,t.width/2,t.height/2),l.font="12px Arial",l.fillStyle="#6b7280",l.fillText(new Date().toLocaleString("ja-JP"),t.width/2,t.height/2+30),e(t.toDataURL());return}let l=new XMLSerializer().serializeToString(t),s=document.createElement("canvas"),a=s.getContext("2d");s.width=400,s.height=300;let r=new Image;r.onload=function(){a.fillStyle="white",a.fillRect(0,0,s.width,s.height);let t=Math.min(s.width/r.width,s.height/r.height),l=(s.width-r.width*t)/2,n=(s.height-r.height*t)/2;a.drawImage(r,l,n,r.width*t,r.height*t),e(s.toDataURL())},r.onerror=function(){a.fillStyle="white",a.fillRect(0,0,s.width,s.height),a.fillStyle="#1f2937",a.font="bold 16px Arial",a.textAlign="center",a.fillText("グラフ画像",s.width/2,s.height/2),e(s.toDataURL())},r.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(l)))}),ek=async()=>{if(!en.trim()){alert("プロジェクト名を入力してください");return}let e=prompt("パターン名を入力してください","パターン"+(el.length+1));if(e){let t=await eS(),l=[...el,{id:Date.now().toString(),name:e,selectedFields:[...I],chartType:M,memo:V,alertSettings:{...ed},timestamp:new Date().toLocaleString("ja-JP"),chartImage:t}];es(l),eC(l)}},eC=t=>{let s={id:en.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),name:en,jsonData:e,extractedFields:l,patterns:t,savedAt:new Date().toLocaleString("ja-JP"),lastModified:new Date().toLocaleString("ja-JP")};eh(e=>{let t=e.findIndex(e=>e.id===s.id);if(!(t>=0))return[...e,s];{let l=[...e];return l[t]=s,l}})},eD=e=>{e.chartImage?window.open("","_blank").document.write("\n        <html>\n          <head><title>".concat(e.name,' - 拡大プレビュー</title></head>\n          <body style="margin: 0; padding: 20px; text-align: center; background: #f9fafb;">\n            <h2>').concat(e.name,"</h2>\n            <p>作成日時: ").concat(e.timestamp,'</p>\n            <img src="').concat(e.chartImage,'" style="max-width: 100%; border: 1px solid #ddd; border-radius: 8px;"/>\n          </body>\n        </html>\n      ')):alert("チャート画像が保存されていません")},eT=(e,t)=>{let l=document.createElement("canvas"),s=l.getContext("2d");l.width=800,l.height=600,s.fillStyle="white",s.fillRect(0,0,l.width,l.height),s.fillStyle="#1f2937",s.font="bold 24px Arial",s.textAlign="center",s.fillText("".concat(e," - ").concat(t.name),l.width/2,50),s.font="16px Arial",s.fillText("作成日時: ".concat(t.timestamp),l.width/2,80),s.fillText("グラフタイプ: ".concat(t.chartType),l.width/2,110);let a=document.createElement("a");a.download="".concat(e,"_").concat(t.name,"_").concat(new Date().toLocaleDateString("ja-JP"),".png"),a.href=l.toDataURL(),a.click()},e_=(e,t,l)=>{ec(s=>({...s,[e]:{min:parseFloat(t)||null,max:parseFloat(l)||null}}))},eA=(e,t)=>{let l=ed[e];return!!l&&(null!==l.min&&t<l.min||null!==l.max&&t>l.max)},eZ=async()=>{et(!0);try{let e=document.createElement("canvas"),t=e.getContext("2d");e.width=1200,e.height=1600,t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t.fillStyle="#1f2937",t.font="bold 24px Arial",t.textAlign="center";let s={bar:"棒グラフ",line:"折れ線グラフ",pie:"円グラフ",composed:"複合グラフ",table:"表"}[M];t.fillText("データ可視化 - "+s,e.width/2,40),en&&(t.font="16px Arial",t.fillStyle="#6b7280",t.fillText("プロジェクト: "+en,e.width/2,70)),t.font="16px Arial",t.textAlign="left",t.fillStyle="#1f2937",t.fillText("選択項目:",50,100);let a=120;I.forEach(e=>{let s=l.find(t=>t.id===e);s&&(t.fillText("• "+s.name+" ("+s.type+")",70,a),a+=25)});let r=a+20;t.strokeStyle="#e5e7eb",t.strokeRect(50,r,e.width-100,400),t.fillStyle="#f3f4f6",t.fillRect(51,r+1,e.width-102,398),t.fillStyle="#6b7280",t.font="18px Arial",t.textAlign="center",t.fillText("チャートエリア",e.width/2,r+200),t.fillText("("+s+")",e.width/2,r+200+30);let n=r+400+40;t.fillStyle="#1f2937",t.font="bold 18px Arial",t.textAlign="left",t.fillText("メモ・要望:",50,n),t.strokeStyle="#d1d5db",t.strokeRect(50,n+10,e.width-100,200),t.fillStyle="#f9fafb",t.fillRect(51,n+11,e.width-102,198),t.fillStyle="#374151",t.font="14px Arial";let i=V.split("\n"),d=n+35;i.forEach(e=>{t.fillText(e,70,d),d+=20}),t.fillStyle="#6b7280",t.font="12px Arial",t.textAlign="center";let c=new Date,o=c.toLocaleDateString("ja-JP")+" "+c.toLocaleTimeString("ja-JP");t.fillText("作成日時: "+o,e.width/2,e.height-20);let m=document.createElement("a"),x=(en?en+"_":"")+"データ可視化_"+s+"_"+c.getFullYear()+String(c.getMonth()+1).padStart(2,"0")+String(c.getDate()).padStart(2,"0")+".png";m.download=x,m.href=e.toDataURL(),m.click()}catch(e){console.error("エクスポートエラー:",e),alert("エクスポートに失敗しました")}et(!1)},eL=[{test1:"サンプル1",test2:100},{test1:"サンプル2",test2:200},{test1:"サンプル3",test2:300}];return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6 text-gray-900",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,a.jsxs)("header",{className:"text-center mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"帳票データ可視化アプリケーション"}),(0,a.jsx)("p",{className:"text-gray-900",children:"JSONデータから自動で項目を抽出し、お客様とのすり合わせ用グラフ・表を生成"}),(0,a.jsxs)("div",{className:"flex justify-center gap-4 mt-6",children:[(0,a.jsxs)("button",{onClick:()=>eu("home"),className:"nav-button ".concat("home"===eg?"active":""),children:[(0,a.jsx)(w.Z,{className:"h-5 w-5 mr-2"}),"ホーム"]}),(0,a.jsxs)("button",{onClick:()=>eu("history"),className:"nav-button ".concat("history"===eg?"active":""),children:[(0,a.jsx)(v.Z,{className:"h-5 w-5 mr-2"}),"プロジェクト履歴"]})]})]}),"home"===eg?(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"project-header",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold flex items-center",children:[(0,a.jsx)(S.Z,{className:"mr-2"}),(0,a.jsx)("span",{className:"text-gray-900",children:"プロジェクト管理"})]}),(0,a.jsxs)("button",{onClick:()=>{if((I.length>0||V.trim()||Object.keys(ed).length>0)&&en.trim()){if(!window.confirm("現在の作業内容をプロジェクト「".concat(en,"」に保存してからリセットしますか？\n\n")+"「OK」: 保存してリセット\n「キャンセル」: リセットせずに作業を続ける"))return;if(I.length>0){let e="作業中パターン_"+new Date().toLocaleTimeString("ja-JP");eC([...el,{id:Date.now().toString(),name:e,selectedFields:[...I],chartType:M,memo:V,alertSettings:{...ed},timestamp:new Date().toLocaleString("ja-JP"),exportedImage:null}])}else el.length>0&&eC(el)}ei(""),t(""),P([]),z([]),es([]),U("bar"),W(""),ec({}),X(!1),Y(!1),em(!1),$(!1),alert("新しいプロジェクトを開始できます")},className:"flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[(0,a.jsx)(k.Z,{className:"h-4 w-4 mr-2"}),"新しいプロジェクトを開始"]})]}),(0,a.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,a.jsx)("input",{type:"text",value:en,onChange:e=>ei(e.target.value),placeholder:"プロジェクト名を入力（例: A社_品質改善_2024）",className:"flex-1 p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),el.length>0&&(0,a.jsxs)("div",{className:"text-sm text-gray-900",children:["保存済みパターン: ",el.length,"個"]})]})]}),(0,a.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 json-file-section",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-6 flex items-center justify-center",children:[(0,a.jsx)(C.Z,{className:"mr-2"}),"JSONデータ取り込み"]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("button",{onClick:()=>{var e;return null===(e=ef.current)||void 0===e?void 0:e.click()},className:"file-input-label w-full bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center",children:[(0,a.jsx)(D.Z,{className:"h-5 w-5 mr-2"}),"JSONファイルを選択"]}),(0,a.jsx)("div",{className:"text-center text-gray-800 text-sm",children:"または"}),(0,a.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),className:"w-full h-40 p-4 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"JSONデータを直接入力してください..."}),(0,a.jsx)("button",{onClick:()=>{e.trim()&&ey(e)},className:"mt-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700",children:"JSONを解析"})]}),(0,a.jsx)("input",{ref:ef,type:"file",accept:".json",onChange:e=>{let l=e.target.files[0];if(l){let e=new FileReader;e.onload=e=>{t(e.target.result),ey(e.target.result)},e.readAsText(l)}},className:"hidden"})]})}),l.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4 flex items-center",children:[(0,a.jsx)(T.Z,{className:"mr-2"}),"提案テンプレート"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(ej).map(e=>{let[t,l]=e;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("h3",{className:"font-semibold text-lg mb-2",children:l.name}),(0,a.jsx)("p",{className:"text-gray-900 text-sm mb-3",children:l.description}),(0,a.jsx)("button",{onClick:()=>ev(t),className:"w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"このテンプレートを適用"})]},t)})})]}),(l.length>0||B)&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold flex items-center",children:[(0,a.jsx)(_.Z,{className:"mr-2"}),"抽出された項目",B&&(0,a.jsx)("span",{className:"ml-2 text-blue-600",children:"解析中..."})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>Y(!G),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center",children:[(0,a.jsx)(A.Z,{className:"h-4 w-4 mr-2"}),"項目追加"]}),(0,a.jsxs)("button",{onClick:()=>em(!eo),className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center",children:[(0,a.jsx)(Z.Z,{className:"h-4 w-4 mr-2"}),"異常値設定"]})]})]}),G&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:(0,a.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"項目名"}),(0,a.jsx)("input",{type:"text",value:H.name,onChange:e=>Q({...H,name:e.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"例: 作業効率, 検査回数"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"データ型"}),(0,a.jsxs)("select",{value:H.type,onChange:e=>Q({...H,type:e.target.value}),className:"p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"number",children:"数値"}),(0,a.jsx)("option",{value:"string",children:"文字列"}),(0,a.jsx)("option",{value:"date",children:"日付"})]})]}),(0,a.jsx)("button",{onClick:()=>{if(H.name.trim()){let e={id:H.name.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),name:H.name,type:H.type};P(t=>[...t,e]),Q({name:"",type:"number"}),Y(!1)}},className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"追加"})]})}),eo&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-orange-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-medium mb-3",children:"異常値検知設定"}),(0,a.jsx)("div",{className:"space-y-3",children:l.filter(e=>"number"===e.type).map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("span",{className:"w-32 text-sm font-medium",children:[e.name,":"]}),(0,a.jsx)("input",{type:"number",placeholder:"下限値",className:"w-20 p-1 border border-gray-300 rounded text-sm",onChange:t=>{var l;return e_(e.id,t.target.value,null===(l=ed[e.id])||void 0===l?void 0:l.max)}}),(0,a.jsx)("span",{className:"text-gray-800",children:"〜"}),(0,a.jsx)("input",{type:"number",placeholder:"上限値",className:"w-20 p-1 border border-gray-300 rounded text-sm",onChange:t=>{var l;return e_(e.id,null===(l=ed[e.id])||void 0===l?void 0:l.min,t.target.value)}})]},e.id))}),(0,a.jsx)("div",{className:"mt-3 p-2 bg-blue-100 rounded",children:(0,a.jsx)("p",{className:"text-sm text-blue-800",children:"\uD83D\uDCA1 ヒント: 異常値の参照線がグラフに表示されます"})})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mb-6",children:l.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[(0,a.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer flex-1",children:[(0,a.jsx)("input",{type:"checkbox",checked:I.includes(e.id),onChange:()=>ew(e.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.name}),(0,a.jsx)("span",{className:"ml-2 text-xs text-gray-800 bg-gray-100 px-2 py-1 rounded",children:e.type}),ed[e.id]&&(0,a.jsx)(N.Z,{className:"inline h-3 w-3 ml-1 text-orange-500"})]})]}),(0,a.jsx)("button",{onClick:()=>eN(e.id),className:"ml-2 text-red-500 hover:text-red-700 transition-colors",children:(0,a.jsx)(L.Z,{className:"h-4 w-4"})})]},e.id))}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"可視化タイプ選択"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[{type:"bar",icon:J.Z,name:"棒グラフ"},{type:"line",icon:R.Z,name:"折れ線グラフ"},{type:"pie",icon:O.Z,name:"円グラフ"},{type:"composed",icon:J.Z,name:"複合グラフ"},{type:"table",icon:s.Grid3X3,name:"表"}].map(e=>{let{type:t,icon:l,name:s}=e;return(0,a.jsxs)("button",{onClick:()=>U(t),className:"p-3 rounded-lg border-2 transition-all "+(M===t?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:[(0,a.jsx)(l,{className:"h-6 w-6 mx-auto mb-1"}),(0,a.jsx)("div",{className:"text-sm font-medium",children:s})]},t)})})]}),(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("h3",{className:"font-medium mb-3 flex items-center",children:[(0,a.jsx)(_.Z,{className:"h-4 w-4 mr-2"}),"お客様からの要望・メモ"]}),(0,a.jsx)("textarea",{value:V,onChange:e=>W(e.target.value),className:"w-full h-32 p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"お客様からの要望や気づいた点をメモしてください..."}),(0,a.jsx)("p",{className:"text-sm text-gray-800 mt-2",children:"このメモも一緒に画像として出力されます"})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,a.jsxs)("button",{onClick:()=>X(!0),disabled:0===I.length,className:"flex items-center space-x-2 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[(0,a.jsx)(F.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"プレビュー生成"})]}),(0,a.jsxs)("button",{onClick:ek,disabled:0===I.length,className:"flex items-center space-x-2 bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[(0,a.jsx)(E.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"パターン保存"})]})]})]}),q&&I.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold",children:["プレビュー - ",{bar:"棒グラフ",line:"折れ線グラフ",pie:"円グラフ",composed:"複合グラフ",table:"表"}[M]]}),(0,a.jsxs)("button",{onClick:eZ,disabled:ee,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 transition-colors",children:[(0,a.jsx)(K.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:ee?"エクスポート中...":"メモ付きエクスポート"})]})]}),(0,a.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(()=>{if(0===I.length)return null;let e=["#8884d8","#82ca9d","#ffc658","#ff7c7c","#8dd1e1"],t=e=>{let{active:t,payload:l,label:s}=e;return t&&l&&l.length?(0,a.jsxs)("div",{className:"bg-white p-3 border border-gray-300 rounded shadow-lg",children:[(0,a.jsx)("p",{className:"font-medium",children:s}),l.map((e,t)=>{let l=eA(e.dataKey,e.value);return(0,a.jsxs)("p",{style:{color:e.color},className:l?"font-bold":"",children:[e.name,": ",e.value,l&&(0,a.jsx)("span",{className:"text-red-500 ml-2",children:"⚠️異常値"})]},t)})]}):null};switch(M){case"bar":return(0,a.jsx)(i.h,{width:"100%",height:400,children:(0,a.jsxs)(d.v,{data:eL.slice(0,10),children:[(0,a.jsx)(c.q,{strokeDasharray:"3 3"}),(0,a.jsx)(o.K,{dataKey:I[0]}),(0,a.jsx)(m.B,{}),(0,a.jsx)(x.u,{content:(0,a.jsx)(t,{})}),(0,a.jsx)(h.D,{}),I.slice(1).map((t,s)=>{let r=l.find(e=>e.id===t);return(null==r?void 0:r.type)==="number"?(0,a.jsx)(n.$,{dataKey:t,fill:e[s%e.length],name:r.name},t):null}),I.slice(1).map((e,t)=>{let l=ed[e];return l?(0,a.jsxs)(r.Fragment,{children:[null!==l.max&&(0,a.jsx)(g.d,{y:l.max,stroke:"red",strokeDasharray:"5 5",label:"上限"}),null!==l.min&&(0,a.jsx)(g.d,{y:l.min,stroke:"red",strokeDasharray:"5 5",label:"下限"})]},e+"_alert"):null})]})});case"line":return(0,a.jsx)(i.h,{width:"100%",height:400,children:(0,a.jsxs)(u.w,{data:eL.slice(0,15),children:[(0,a.jsx)(c.q,{strokeDasharray:"3 3"}),(0,a.jsx)(o.K,{dataKey:I[0]}),(0,a.jsx)(m.B,{}),(0,a.jsx)(x.u,{content:(0,a.jsx)(t,{})}),(0,a.jsx)(h.D,{}),I.slice(1).map((t,s)=>{let r=l.find(e=>e.id===t);return(null==r?void 0:r.type)==="number"?(0,a.jsx)(p.x,{type:"monotone",dataKey:t,stroke:e[s%e.length],name:r.name},t):null}),I.slice(1).map((e,t)=>{let l=ed[e];return l?(0,a.jsxs)(r.Fragment,{children:[null!==l.max&&(0,a.jsx)(g.d,{y:l.max,stroke:"red",strokeDasharray:"5 5",label:"上限"}),null!==l.min&&(0,a.jsx)(g.d,{y:l.min,stroke:"red",strokeDasharray:"5 5",label:"下限"})]},e+"_alert"):null})]})});case"pie":let s=I.find(e=>{let t=l.find(t=>t.id===e);return(null==t?void 0:t.type)==="string"});if(!s)return(0,a.jsx)("div",{className:"text-gray-800",children:"円グラフには文字列項目を選択してください"});let w=Object.entries(eL.reduce((e,t)=>{let l=t[s];return e[l]=(e[l]||0)+1,e},{})).map(e=>{let[t,l]=e;return{name:t,value:l}});return(0,a.jsx)(i.h,{width:"100%",height:400,children:(0,a.jsxs)(b.u,{children:[(0,a.jsx)(f.b,{data:w,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{name:t,percent:l}=e;return t+" "+(100*l).toFixed(0)+"%"},outerRadius:80,fill:"#8884d8",dataKey:"value",children:w.map((t,l)=>(0,a.jsx)(j.b,{fill:e[l%e.length]},"cell-"+l))}),(0,a.jsx)(x.u,{})]})});case"composed":return(0,a.jsx)(i.h,{width:"100%",height:400,children:(0,a.jsxs)(y.c,{data:eL.slice(0,12),children:[(0,a.jsx)(c.q,{strokeDasharray:"3 3"}),(0,a.jsx)(o.K,{dataKey:I[0]}),(0,a.jsx)(m.B,{}),(0,a.jsx)(x.u,{content:(0,a.jsx)(t,{})}),(0,a.jsx)(h.D,{}),I.slice(1).map((t,s)=>{let r=l.find(e=>e.id===t);return(null==r?void 0:r.type)==="number"?s%2==0?(0,a.jsx)(n.$,{dataKey:t,fill:e[s%e.length],name:r.name},t):(0,a.jsx)(p.x,{type:"monotone",dataKey:t,stroke:e[s%e.length],name:r.name},t):null})]})});case"table":return(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full border-collapse border border-gray-300",children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{className:"bg-gray-50",children:I.map(e=>{let t=l.find(t=>t.id===e);return(0,a.jsxs)("th",{className:"border border-gray-300 px-4 py-2 text-left font-medium",children:[null==t?void 0:t.name,ed[e]&&(0,a.jsx)(N.Z,{className:"inline h-4 w-4 ml-1 text-red-500"})]},e)})})}),(0,a.jsx)("tbody",{children:eL.slice(0,10).map((e,t)=>(0,a.jsx)("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:I.map(t=>{let l=e[t],s=eA(t,l);return(0,a.jsxs)("td",{className:"border border-gray-300 px-4 py-2"+(s?" bg-red-100 text-red-700 font-bold":""),children:[l,s&&(0,a.jsx)("span",{className:"ml-2",children:"⚠️"})]},t)})},t))})]})});default:return null}})()}),(0,a.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"選択中の項目:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:I.map(e=>{let t=l.find(t=>t.id===e),s=ed[e];return(0,a.jsxs)("span",{className:s?"bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm":"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm",children:[null==t?void 0:t.name,s&&(0,a.jsx)(N.Z,{className:"inline h-3 w-3 ml-1"})]},e)})}),Object.keys(ed).length>0&&(0,a.jsx)("div",{className:"mt-3 p-2 bg-orange-100 rounded",children:(0,a.jsxs)("p",{className:"text-sm text-orange-800",children:[(0,a.jsx)(N.Z,{className:"inline h-4 w-4 mr-1"}),"異常値監視が有効です。設定された閾値を超えた値は赤色で表示されます。"]})})]})]})]}):(0,a.jsx)("div",{className:"space-y-6",children:0===ex.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(S.Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"保存されたプロジェクトはありません"}),(0,a.jsx)("p",{className:"text-gray-800",children:"ホーム画面でプロジェクトを作成してパターンを保存してください"})]}):(0,a.jsx)("div",{className:"grid gap-6",children:ex.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:e.name}),(0,a.jsxs)("p",{className:"text-gray-800 text-sm",children:["作成: ",e.savedAt," | 最終更新: ",e.lastModified]}),(0,a.jsxs)("p",{className:"text-gray-900 text-sm mt-1",children:["パターン数: ",e.patterns.length,"個"]})]})}),e.patterns.length>0&&(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:"保存されたパターン:"}),(0,a.jsx)("div",{className:"grid gap-3",children:e.patterns.map(t=>(0,a.jsxs)("div",{className:"flex gap-4 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:t.chartImage?(0,a.jsx)("img",{src:t.chartImage,alt:"".concat(t.name,"のグラフ"),className:"w-24 h-20 object-cover border border-gray-300 rounded cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>eD(t),title:"クリックで拡大表示"}):(0,a.jsx)("div",{className:"w-24 h-20 bg-gray-200 border border-gray-300 rounded flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-xs text-gray-500 text-center",children:"画像なし"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h5",{className:"font-medium text-gray-800",children:t.name}),(0,a.jsxs)("p",{className:"text-sm text-gray-900",children:["bar"===t.chartType?"棒グラフ":"line"===t.chartType?"折れ線グラフ":"pie"===t.chartType?"円グラフ":"composed"===t.chartType?"複合グラフ":"表"," | ",t.timestamp]}),t.memo&&(0,a.jsxs)("p",{className:"text-sm text-gray-800 mt-1 line-clamp-2",children:["メモ: ",t.memo]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("button",{onClick:()=>eD(t),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",title:"拡大表示",children:"拡大"}),(0,a.jsx)("button",{onClick:()=>eT(e.name,t),className:"px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 transition-colors",children:"DL"})]})]},t.id))})]})]},e.id))})})]})})}}},function(e){e.O(0,[119,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);